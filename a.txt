import e from "express";
import { getAll, create, getById } from "../services/kompetencia.service.js";

const router = e.Router();

/**
 * @swagger
 * tags:
 *   name: Kompetencia
 *   description: School competency measurements management
 *
 * components:
 *   schemas:
 *     Kompetencia:
 *       type: object
 *       properties:
 *         id:
 *           type: integer
 *           description: Unique identifier
 *           example: 1
 *         alapadatok_id:
 *           type: integer
 *           description: School identifier reference
 *           example: 1
 *         tanev_kezdete:
 *           type: string
 *           description: School year start date
 *           example: "2024-09-01"
 *         mat_orsz_p:
 *           type: number
 *           format: float
 *           description: National mathematics percentage
 *           example: 78.5
 *         szoveg_orsz_p:
 *           type: number
 *           format: float
 *           description: National text comprehension percentage
 *           example: 82.3
 *         mat_int_p:
 *           type: number
 *           format: float
 *           description: Institution mathematics percentage
 *           example: 75.8
 *         szoveg_int_p:
 *           type: number
 *           format: float
 *           description: Institution text comprehension percentage
 *           example: 80.1
 *         kepzes_forma:
 *           type: string
 *           description: Type of education
 *           example: "Technikum"
 *         createdAt:
 *           type: string
 *           format: date-time
 *           description: Creation timestamp
 *         updatedAt:
 *           type: string
 *           format: date-time
 *           description: Last update timestamp
 *       required:
 *         - alapadatok_id
 *         - tanev_kezdete
 *         - mat_orsz_p
 *         - szoveg_orsz_p
 *         - mat_int_p
 *         - szoveg_int_p
 *         - kepzes_forma
 */

/**
 * @swagger
 * /kompetencia:
 *   get:
 *     summary: Get all competency measurements
 *     description: Retrieve a list of all competency measurements for all schools
 *     tags: [Kompetencia]
 *     security:
 *       - bearerAuth: []
 *     responses:
 *       200:
 *         description: Success - List of competency data
 *         content:
 *           application/json:
 *             schema:
 *               type: array
 *               items:
 *                 $ref: '#/components/schemas/Kompetencia'
 *       401:
 *         description: Unauthorized - Invalid or missing token
 *       500:
 *         description: Server error
 */
router.get("/", async (req, res) => {
  const data = await getAll();

  res.status(200).json(data);
});

/**
 * @swagger
 * /kompetencia/{alapadatok_id}:
 *   get:
 *     summary: Get competency data by school ID
 *     description: Retrieve competency measurements for a specific school
 *     tags: [Kompetencia]
 *     security:
 *       - bearerAuth: []
 *     parameters:
 *       - in: path
 *         name: alapadatok_id
 *         required: true
 *         schema:
 *           type: integer
 *         description: School unique identifier
 *     responses:
 *       200:
 *         description: Success - School competency data
 *         content:
 *           application/json:
 *             schema:
 *               type: array
 *               items:
 *                 $ref: '#/components/schemas/Kompetencia'
 *       401:
 *         description: Unauthorized - Invalid or missing token
 *       500:
 *         description: Server error
 */
router.get("/:alapadatok_id", async (req, res) => {
  const data = await getById(req.params.alapadatok_id);

  res.status(200).json(data);
});

/**
 * @swagger
 * /kompetencia:
 *   post:
 *     summary: Create new competency record
 *     description: Add a new competency measurement for a school
 *     tags: [Kompetencia]
 *     security:
 *       - bearerAuth: []
 *     requestBody:
 *       required: true
 *       content:
 *         application/json:
 *           schema:
 *             type: object
 *             required:
 *               - alapadatok_id
 *               - tanev_kezdete
 *               - mat_orsz_p
 *               - szoveg_orsz_p
 *               - mat_int_p
 *               - szoveg_int_p
 *               - kepzes_forma
 *             properties:
 *               alapadatok_id:
 *                 type: integer
 *                 example: 1
 *               tanev_kezdete:
 *                 type: string
 *                 example: "2024-09-01"
 *               mat_orsz_p:
 *                 type: number
 *                 format: float
 *                 example: 78.5
 *               szoveg_orsz_p:
 *                 type: number
 *                 format: float
 *                 example: 82.3
 *               mat_int_p:
 *                 type: number
 *                 format: float
 *                 example: 75.8
 *               szoveg_int_p:
 *                 type: number
 *                 format: float
 *                 example: 80.1
 *               kepzes_forma:
 *                 type: string
 *                 example: "Technikum"
 *     responses:
 *       201:
 *         description: Successfully created
 *         content:
 *           application/json:
 *             schema:
 *               $ref: '#/components/schemas/Kompetencia'
 *       400:
 *         description: Invalid data
 *       401:
 *         description: Unauthorized - Invalid or missing token
 *       500:
 *         description: Server error
 */
router.post("/", async (req, res) => {
  try {
    const {
      alapadatok_id,
      tanev_kezdete,
      mat_orsz_p,
      szoveg_orsz_p,
      mat_int_p,
      szoveg_int_p,
      kepzes_forma,
    } = req.body;

    const data = await create(
      alapadatok_id,
      tanev_kezdete,
      mat_orsz_p,
      szoveg_orsz_p,
      mat_int_p,
      szoveg_int_p,
      kepzes_forma
    );

    res.status(201).json(data);
  } catch (error) {
    console.error(error);
    res.status(400).json(error);
  }
});

export default router;

Tanuló (Oktatási azonosító)	Intézmény OM azonosító	Intézmény név	Intézmény székhely település név	Intézmény székhely település irányítószám	Intézmény székhely cím	Intézmény székhely e-mail	Feladatellátási hely azonosító/Működési hely hosszú azonosító	Feladatellátási hely név	Feladatellátási hely település név	Feladatellátási hely település irányítószám	Feladatellátási hely cím	Feladatellátási hely e-mail	Lakóhely-tanuló lakóhely település	Lakóhely - szülő állandó lakóhely település	Lakóhely - külföldi állampolgár tartózkodási hely település	Tanuló Koréve	Tanuló jogviszonya	Nem	Feladatellátási hely típus/ellátott feladat	Tantervi jellemző	Munkarend	Évfolyam	Régi Szkt. - OKJ: Szakmacsoport	Régi Szkt. - OKJ: Ágazat	Régi Szkt. - OKJ: Szakképesítés megnevezése	Régi Szkt. - OKJ: Szakképesítés kód	Régi Szkt. - OKJ: Részszakképesítés	Új Szkt. - Szakmajegyzék: Ágazat	Új Szkt. - Szakmajegyzék: Szakma megnevezése	Új Szkt. - Szakmajegyzék: Szakma kód	Új Szkt. - Szakmajegyzék: Szakmairány	Új Szkt. - Részszakmák: Ágazat	Új Szkt. - Részszakma: Szakma	Új Szkt. - Részszakmák: Részszakma	Nkt. - Szakgimnáziumban oktatható képzések: Tanulmányi terület	Nkt. - Szakgimnáziumban oktatható képzések: Szakképesítés megnevezése	Nkt. - Szakgimnáziumban oktatható képzések: Szakképesítés kód	Nkt. - Szakgimnáziumban oktatható képzések: Szakirány	Programkövetelményes szakmai képzés: Ágazat/Tanulmányi terület	Programkövetelményes szakmai képzés: Szakmai képzés megnevezése	Programkövetelményes szakmai képzés	Állampolgárság országa 1	Állampolgárság országa 2	Sajátos nevelési igény	Sajátos nevelési igény - gyógypedagógiai tanterv szerint nevelt	Sajátos nevelési igény - integráltan nevelt	Fogyatékosság típusa	Kiemelten tehetséges	Évfolyamismétlő	Egyéni tanrend szerint tanul	Tanműhelyben tanul	Más településről bejár	Kollégiumban lakik	Externátusi ellátásban részesített	Szociális ösztöndíjban, illetve szociális támogatásban részesül	Étkeztetésben részesül	Gyakorlathoz köthető jogviszony	Beilleszkedési, tanulási, magatartási nehézséggel küzdő	Napköziotthoni ellátásban részesül	Hátrányos helyzetű	Halmozottan hátrányos helyzetű	Rendszeres gyermekvédelmi kedvezményben részesül	Számítógépet oktatási célra használ	Hit- és erkölcstan oktatásban vesz részt	Etika oktatásban részesül	Nyelvoktatásban részesül	Nyelvoktatás alól felmentett	Tandíjas	Térítési díjas	Kezdő évfolyamos tanuló	Iskolai sportkörben résztvevő tanuló	Diáksport egyesület tagja	Szabóky Adolf Szakképzési Ösztöndíjban részesülők (hiány-szakképesítési tanulók)	Arany János Tehetséggondozó Program	Emelt szintű oktatásban vesz részt	Emelt szintű oktatás - tantárgy 1	Emelt szintű oktatás - tantárgy 2	Emelt szintű oktatás - tantárgy 3	Tanult idegen nyelv 1	Tanult idegen nyelv 2	Tanult idegen nyelv 3	Tanuló nemzetiségi nyelvoktatása	Nemzetiségi nevelés-oktatás fajtája	Nemzetiségi nyelv	Egész napos iskolai oktatásban részesül	A 9. évfolyamosok közül a 8. évfolyamot az előző tanévben végezte	Otthon nyújtott ellátási formában részesül
